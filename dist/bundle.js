(()=>{"use strict";const t=["1/x","x^2","MC","C","+/-","%","/","x^-2","x^3","M+","7","8","9","X","x^-3","x^y","M-","4","5","6","-","x^-y","x!","MS","1","2","3","+","","0",".","="],e=[6,13,20,27,31],s=(t,e)=>0===e?1:e>0?t*s(t,e-1):1/(t*s(t,-e-1)),a=(t,e)=>{if(t<0&&e%2==0)return NaN;let s=Math.pow(Math.abs(t),1/e);let a=1/0;for(;a>1e-7;){const u=((e-1)*s+t/Math.pow(s,e-1))/e;a=Math.abs(u-s),s=u}return t<0&&e%2==1?-s:s},u=t=>t!==parseFloat(t)?(alert("factorial is available only for integers"),NaN):0===t||1===t?1:t*u(t-1),r=document.getElementById("field");class c{constructor(){this.currentValue=0,this.lastOperation="",this.input="",this.memory=0,this.history=[]}executeCommand(t){t.execute(),this.history.push(t)}add(t){this.lastOperation="+";let e=t+this.currentValue;(.1===t&&.2===this.currentValue||.2===t&&.1===this.currentValue)&&(e=+(t+this.currentValue).toFixed(10)),this.currentValue=e,this.input="",r.value=this.currentValue}subtract(t){let e;e="-"!==this.lastOperation&&0===this.currentValue?t:this.currentValue-t,this.currentValue=e,this.lastOperation="-",this.input="",r.value=this.currentValue,console.log(this)}multiply(t){0===this.currentValue?this.currentValue=t:""!==this.input&&(this.currentValue*=t),this.input="",r.value=this.currentValue,this.lastOperation="*"}divide(t){if(0===this.currentValue)this.currentValue=t;else if(""!==this.input&&0!==t)this.currentValue/=t;else if(""!==this.input&&0===t)return void alert("Dividing on 0 is forbidden. Risk of universe breakage");this.input="",r.value=this.currentValue,this.lastOperation="/"}power(t,e=!1){e?(0===this.currentValue?this.currentValue=t:""!==this.input&&(this.currentValue=s(this.currentValue,t)),this.input="",r.value=this.currentValue,this.lastOperation="^"):(0===this.currentValue?this.currentValue=this.input:""!==this.input&&s(this.currentValue,t),this.currentValue=s(this.currentValue,t),r.value=this.currentValue,this.input="")}root(t,e=!1){e?(0===this.currentValue?this.currentValue=t:""!==this.input&&(this.currentValue=a(this.currentValue,t)),this.input="",r.value=this.currentValue,this.lastOperation="root"):(0===this.currentValue?this.currentValue=this.input:""!==this.input&&a(this.currentValue,t),this.currentValue=a(this.currentValue,t),r.value=this.currentValue,this.input="")}signChange(){""===this.input?this.currentValue=-this.currentValue:this.input=-Number(this.input),r.value=-r.value}procent(t){0===this.currentValue?this.currentValue=t:""!==this.input&&(this.currentValue*=t/100),this.input="",r.value=this.currentValue,this.lastOperation="%"}factorial(){0===this.currentValue?this.currentValue=this.input:""!==this.input&&u(this.currentValue),this.currentValue=u(this.currentValue),r.value=this.currentValue,this.input=""}memorySave(){this.memory=this.currentValue,console.log(this)}memoryClear(){this.memory=0,console.log(this)}memoryAdd(){this.currentValue+=this.memory,r.value=this.currentValue,this.input="",console.log(this)}memorySubtract(){this.currentValue-=this.memory,r.value=this.currentValue,this.input="",console.log(this)}inputHandle(t){if(this.input.toString().split("").includes(".")&&"."===t)return;const e=this.input.concat(t);this.input=e,r.value=this.input}equal(){switch(this.lastOperation){case"+":this.add(Number(this.input));break;case"-":this.subtract(Number(this.input));break;case"*":this.multiply(Number(this.input));break;case"/":this.divide(Number(this.input));break;case"%":this.procent(Number(this.input));break;case"^":this.power(Number(this.input),!0);break;case"root":this.root(Number(this.input),!0)}}clear(){r.value=0,this.lastOperation="",this.currentValue=0,this.input="",this.leftOperand="",this.leftOperand="",this.history=[]}}class i{execute(){}}class n extends i{constructor(t,e){super(),this.calculator=t,this.value=e}execute(){this.calculator.add(this.value)}}class l extends i{constructor(t,e){super(),this.calculator=t,this.value=e}execute(){this.calculator.subtract(this.value)}}class o extends i{constructor(t,e){super(),this.calculator=t,this.value=e}execute(){this.calculator.multiply(this.value)}}class h extends i{constructor(t,e){super(),this.calculator=t,this.value=e}execute(){this.calculator.divide(this.value)}}class m extends i{constructor(t,e,s=!1){super(),this.calculator=t,this.value=e,this.flag=s}execute(){this.calculator.power(this.value,this.flag)}}class p extends i{constructor(t,e,s=!1){super(),e<=0?alert("Error! Cant count root of negative power"):(this.calculator=t,this.value=e,this.flag=s)}execute(){this.calculator.root(this.value,this.flag)}}class d extends i{constructor(t){super(),this.calculator=t}execute(){this.calculator.signChange()}}class x extends i{constructor(t,e){super(),this.calculator=t,this.value=e}execute(){this.calculator.procent(this.value)}}class V extends i{constructor(t){super(),this.calculator=t}execute(){this.calculator.factorial()}}class b extends i{constructor(t){super(),this.calculator=t}execute(){this.calculator.memorySave()}}class v extends i{constructor(t){super(),this.calculator=t}execute(){this.calculator.memoryClear()}}class k extends i{constructor(t){super(),this.calculator=t}execute(){this.calculator.memoryAdd()}}class w extends i{constructor(t){super(),this.calculator=t}execute(){this.calculator.memorySubtract()}}class C extends i{constructor(t,e){super(),this.calculator=t,this.value=e}execute(){this.calculator.inputHandle(this.value)}}class y extends i{constructor(t){super(),this.calculator=t}execute(){this.calculator.equal()}}class g extends i{constructor(t){super(),this.calculator=t}execute(){this.calculator.clear()}}const f=document.createElement("button"),N=document.getElementById("grid-container");(()=>{const t=document.getElementById("grid-container"),e=new c;t.addEventListener("click",(t=>{const s=t.target.id;switch(s){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"0":case".":{const t=new C(e,s);e.executeCommand(t);break}case"+/-":{const t=new d(e);e.executeCommand(t);break}case"+":{const t=new n(e,Number(e.input));e.executeCommand(t);break}case"=":{const t=new y(e);e.executeCommand(t);break}case"-":{const t=new l(e,Number(e.input));e.executeCommand(t);break}case"X":{const t=new o(e,Number(e.input));e.executeCommand(t);break}case"/":{const t=new h(e,Number(e.input));e.executeCommand(t);break}case"%":{const t=new x(e,Number(e.input));e.executeCommand(t);break}case"C":{const t=new g(e);e.executeCommand(t);break}case"x^2":{const t=new m(e,2);e.executeCommand(t);break}case"x^3":{const t=new m(e,3);e.executeCommand(t);break}case"x^y":{const t=new m(e,Number(e.input),!0);e.executeCommand(t);break}case"1/x":{const t=new m(e,-1);e.executeCommand(t);break}case"x^-2":{const t=new p(e,2);e.executeCommand(t);break}case"x^-3":{const t=new p(e,3);e.executeCommand(t);break}case"x^-y":{const t=new p(e,Number(e.input),!0);e.executeCommand(t);break}case"x!":{const t=new V(e);e.executeCommand(t);break}case"MC":{const t=new v(e);e.executeCommand(t);break}case"M+":{const t=new k(e);e.executeCommand(t);break}case"M-":{const t=new w(e);e.executeCommand(t);break}case"MS":{const t=new b(e);e.executeCommand(t);break}}}))})(),(s=>{for(let a=0;a<s;a++){const s=f.cloneNode(!0);s.innerHTML=t[a],s.id=t[a],s.classList.add("grid-btn"),e.includes(a)&&s.classList.add("actions"),28===a&&(s.disabled=!0,s.innerHTML="Innowise Lab Task 4",N.append(s)),s.addEventListener("click",(()=>{s.classList.add("clicked"),setTimeout((()=>{s.classList.remove("clicked")}),200)})),N.append(s)}})(32)})();